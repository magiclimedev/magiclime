<tr class="sensor-row <%= sensor.status %>" data-sensor-id="<%= sensor.id %>" onclick="viewSensorDetails(<%= sensor.id %>)">
    <td class="status-cell">
        <span class="status-dot <%= sensor.status %>">
            <%= sensor.status === 'active' ? '●' : '○' %>
        </span>
    </td>
    <td class="name-cell">
        <span class="sensor-name" data-editable="<%= sensor.id %>"><%= sensor.name %></span>
    </td>
    <td class="uid-cell">
        <span class="sensor-uid"><%= sensor.uid %></span>
    </td>
    <% if (sensor.logs && sensor.logs.length > 0) { %>
        <% 
        const logData = sensor.logs[0].data;
        let temperature = '--';
        let humidity = '--';
        
        if (typeof logData === 'object' && logData !== null) {
            if (logData.temperature && logData.humidity) {
                temperature = logData.temperature;
                humidity = logData.humidity;
            } else if (logData.value1 && logData.value2) {
                temperature = logData.value1;
                humidity = logData.value2;
            }
        }
        %>
        <td class="temp-cell"><%= temperature %>°F</td>
        <td class="humidity-cell"><%= humidity %>%</td>
        
        <% 
        const batteryVoltage = sensor.logs[0].bat || 0;
        let batteryPercent = 0;
        let batteryClass = 'dead';
        
        if (batteryVoltage >= 3.0) {
            batteryPercent = 100;
            batteryClass = 'good';
        } else if (batteryVoltage >= 2.7) {
            batteryPercent = Math.round(80 + ((batteryVoltage - 2.7) / 0.3) * 20);
            batteryClass = 'good';
        } else if (batteryVoltage >= 2.5) {
            batteryPercent = Math.round(40 + ((batteryVoltage - 2.5) / 0.2) * 40);
            if (batteryPercent >= 70) batteryClass = 'good';
            else if (batteryPercent >= 50) batteryClass = 'warning';
            else batteryClass = 'low';
        } else if (batteryVoltage > 0) {
            batteryPercent = Math.round((batteryVoltage / 2.5) * 40);
            batteryClass = 'dead';
        }
        %>
        <td class="battery-cell">
            <div class="battery-icon-small <%= batteryClass %>" title="<%= batteryVoltage ? batteryVoltage + 'V' : 'N/A' %>">
                <div class="battery-body-small">
                    <div class="battery-fill" style="width: <%= batteryPercent %>%"></div>
                </div>
                <span class="battery-text"><%= batteryPercent %>%</span>
            </div>
        </td>
        
        <td class="signal-cell">
            <div class="signal-bars-small">
                <% 
                const rss = parseInt(sensor.logs[0].rss) || 0;
                let bars = 0;
                // RSS values are positive for strong signals, use direct comparison
                const signalStrength = rss;
                if (signalStrength >= 90) bars = 4;
                else if (signalStrength >= 70) bars = 3;
                else if (signalStrength >= 50) bars = 2;
                else if (signalStrength >= 30) bars = 1;
                %>
                <% for (let i = 1; i <= 4; i++) { %>
                    <div class="bar <%= i <= bars ? 'active' : '' %>"></div>
                <% } %>
            </div>
        </td>
        
        <td class="path-cell">
            <% 
            const pathIndicator = sensor.logs[0].pathIndicator || sensor.logs[0].path_indicator;
            const path = sensor.logs[0].path || 'direct';
            const isRepeater = pathIndicator === 'R' || path === 'repeater';
            %>
            <span class="path-badge <%= isRepeater ? 'repeater' : 'direct' %>">
                <%= isRepeater ? 'Repeater' : 'Direct' %>
            </span>
        </td>
        
        <td class="update-cell" data-timestamp="<%= sensor.logs[0].createdAt %>">
            <span class="last-updated" data-timestamp="<%= sensor.logs[0].createdAt %>">
                <%= new Date(sensor.logs[0].createdAt).toLocaleTimeString([], {hour: '2-digit', minute:'2-digit'}) %>
            </span>
        </td>
    <% } else { %>
        <td colspan="7" class="no-data-cell">No recent data</td>
    <% } %>
</tr>